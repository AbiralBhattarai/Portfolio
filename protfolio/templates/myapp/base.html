<!doctype html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title_block %}{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    {% load static %}
    <link rel="stylesheet" href="{% static 'myapp/style.css' %}">
  </head>
  <body style="min-height: 100vh; display: flex; flex-direction: column;">
    {% include 'myapp/navbar.html' %}
    
    <!-- Page Transition Overlay -->
    <div id="pageTransition" class="page-transition">
      <div class="transition-loader" id="transitionLoader"></div>
    </div>
    
    <main id="mainContent" style="flex: 1 0 auto;">
      {% block child_block %}{% endblock %}
    </main>
    {% include 'myapp/footer.html' %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <script src="{% static 'myapp/darkmode.js' %}"></script>
    <script>
      // Page Transition Animation
      const vehicles = ['airplane', 'car'];
      const transitionOverlay = document.getElementById('pageTransition');
      const transitionLoader = document.getElementById('transitionLoader');
      
      // Randomly choose vehicle
      const chosenVehicle = vehicles[Math.floor(Math.random() * vehicles.length)];
      const icon = chosenVehicle === 'airplane' ? 'bi-airplane-fill' : 'bi-car-front-fill';
      transitionLoader.innerHTML = `<i class="bi ${icon}"></i>`;
      transitionLoader.classList.add(chosenVehicle);
      
      // Intercept all internal links
      document.addEventListener('DOMContentLoaded', function() {
        const links = document.querySelectorAll('a[href^="/"], a[href^="{% url "home" %}"]');
        
        links.forEach(link => {
          link.addEventListener('click', function(e) {
            const href = this.getAttribute('href');
            
            // Don't intercept external links or anchors
            if (!href || href.startsWith('#') || href.startsWith('http')) return;
            
            e.preventDefault();
            
            // Show transition
            transitionOverlay.classList.add('active');
            
            // Navigate after animation
            setTimeout(() => {
              window.location.href = href;
            }, 800);
          });
        });
      });
    </script>
  </body>
</html>